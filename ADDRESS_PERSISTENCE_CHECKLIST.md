# –ß–µ–∫-–ª–∏—Å—Ç: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –∞–¥—Ä–µ—Å–∞ –ø—Ä–æ–ø–∞–¥–∞—é—Ç –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è –º–∏–Ω–∏-–∞–ø–ø–∞.

## –ê–Ω–∞–ª–∏–∑

### ‚úÖ –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–§—É–Ω–∫—Ü–∏—è `loadSavedAddresses()`** (`public/app.js:2495-2530`):
- –¢–æ–ª—å–∫–æ —Ä–µ–Ω–¥–µ—Ä–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –º–∞—Å—Å–∏–≤–∞ `savedAddresses`
- –ù–µ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö

**–ó–∞–≥—Ä—É–∑–∫–∞ –∞–¥—Ä–µ—Å–æ–≤** (`public/app.js:506-514`):
```javascript
if (data.addresses && Array.isArray(data.addresses)) {
    savedAddresses = data.addresses;
    localStorage.setItem('savedAddresses', JSON.stringify(savedAddresses));
}
loadSavedAddresses();
```

**–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤** (`public/app.js:456-464`):
```javascript
body: JSON.stringify({
    userId: userId,
    addresses: savedAddresses,  // ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –º–∞—Å—Å–∏–≤ –∞–¥—Ä–µ—Å–æ–≤
    // ...
})
```

### ‚úÖ –ë—ç–∫–µ–Ω–¥ endpoints –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**POST `/api/user-data`** (`bot.js:1306-1389`):
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç `addresses` –∏–∑ `req.body` ‚úÖ
- –í—ã–∑—ã–≤–∞–µ—Ç `saveUserAddresses(user.id, addresses)` ‚úÖ
- –õ–æ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚úÖ

**GET `/api/user-data/:userId`** (`bot.js:1392-1442`):
- –í—ã–∑—ã–≤–∞–µ—Ç `loadUserAddresses(user.id)` ‚úÖ
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `addresses: addresses` ‚úÖ

### ‚úÖ –§—É–Ω–∫—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

**`saveUserAddresses(userId, addresses)`** (`bot.js:849-934`):
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (BEGIN/COMMIT/ROLLBACK)
- ‚úÖ –£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –∞–¥—Ä–µ—Å–∞ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–∏ –ø—É—Å—Ç–æ–º –º–∞—Å—Å–∏–≤–µ

**`loadUserAddresses(userId)`** (`bot.js:937-968`):
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∞–¥—Ä–µ—Å–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `addresses`
- ‚úÖ –ú–∞–ø–ø–∏—Ç –ø–æ–ª—è –ë–î –≤ —Ñ–æ—Ä–º–∞—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –∞–¥—Ä–µ—Å–æ–≤

## –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ API

**–í DevTools ‚Üí Network:**
1. –û—Ç–∫—Ä–æ–π –º–∏–Ω–∏-–∞–ø–ø –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å `GET /api/user-data/:userId`
3. –ü—Ä–æ–≤–µ—Ä—å Response:
   ```json
   {
     "addresses": [...],  // ‚úÖ –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–ª–µ "addresses"
     "profile": {...},
     "activeOrders": [...],
     ...
   }
   ```

**–ï—Å–ª–∏ –ø–æ–ª–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ-–¥—Ä—É–≥–æ–º—É** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `user.addresses` –∏–ª–∏ `deliveryAddresses`):
- –ù—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥: `data.addresses` ‚Üí `data.user.addresses`

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–í DevTools ‚Üí Network:**
1. –î–æ–±–∞–≤—å –∞–¥—Ä–µ—Å –≤ –ø—Ä–æ—Ñ–∏–ª–µ
2. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å `POST /api/user-data`
3. –ü—Ä–æ–≤–µ—Ä—å Request Payload:
   ```json
   {
     "userId": "...",
     "addresses": [
       {
         "id": 1,
         "name": "–ú–æ–π –¥–æ–º",
         "city": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
         "street": "...",
         ...
       }
     ],
     ...
   }
   ```

**–ï—Å–ª–∏ `addresses` –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ `[]`:**
- –ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ: `savedAddresses` –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∞–¥—Ä–µ—Å–∞

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞

**–í Render.com ‚Üí Logs:**
–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:
```
‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ... (user_id=...): 1
‚úÖ saveUserAddresses: –¥–æ–±–∞–≤–ª–µ–Ω–æ 1 –∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è user_id=..., –ø—Ä–æ–ø—É—â–µ–Ω–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤=0
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—à—å –æ—à–∏–±–∫–∏:**
- `–û—à–∏–±–∫–∞ saveUserAddresses: ...` ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ —Å –ë–î –∏–ª–∏ SQL –∑–∞–ø—Ä–æ—Å–æ–º
- `‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤` ‚Üí —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–∫–∞—Ç–∏–ª–∞—Å—å

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–î –Ω–∞–ø—Ä—è–º—É—é

**–í Render.com ‚Üí PostgreSQL –∏–ª–∏ —á–µ—Ä–µ–∑ psql:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ –∞–¥—Ä–µ—Å–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT * FROM addresses WHERE user_id = (
    SELECT id FROM users WHERE telegram_id = 'YOUR_TELEGRAM_ID'
);

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã
\d addresses
```

**–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è:**
- –ê–¥—Ä–µ—Å–∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏: –Ω–µ –¥—Ä–æ–ø–∞—é—Ç –ª–∏ –æ–Ω–∏ —Ç–∞–±–ª–∏—Ü—É –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

### 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ë–î

**–í–∞–∂–Ω–æ –¥–ª—è Render.com:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PostgreSQL (–ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è –ë–î)
- ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLite –∏–ª–∏ —Ñ–∞–π–ª –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ (—Å—Ç–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–∏ –¥–µ–ø–ª–æ–µ)
- ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è in-memory –ë–î

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏:**
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–µ—Ç `DROP TABLE addresses` –≤ –º–∏–≥—Ä–∞—Ü–∏—è—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `CREATE TABLE IF NOT EXISTS` –≤–º–µ—Å—Ç–æ `CREATE TABLE`

### 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–∑–æ–≤—ã `saveUserData()`

**–í –∫–æ–¥–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:**
- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∞–¥—Ä–µ—Å–∞: –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `saveUserData()` ‚úÖ
- –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∞–¥—Ä–µ—Å–∞: –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `saveUserData()` ‚úÖ
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∞–¥—Ä–µ—Å–∞: –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `saveUserData()` ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `savedAddresses` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è:**
```javascript
// –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞
savedAddresses.push(newAddress);
saveUserData(); // ‚úÖ –î–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
```

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ —Å–¥–µ–ª–∞–Ω—ã

1. ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏** (`saveUserAddresses`):
   - –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ `[]`, –∞–¥—Ä–µ—Å–∞ –ù–ï —É–¥–∞–ª—è—é—Ç—Å—è
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

2. ‚úÖ **–£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**:
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –î–û —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–∞—Ä—ã—Ö –∞–¥—Ä–µ—Å–æ–≤
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤–Ω—É—Ç—Ä–∏ –Ω–æ–≤–æ–≥–æ –º–∞—Å—Å–∏–≤–∞

## –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

1. **–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:**
   - –û—Ç–∫—Ä–æ–π –º–∏–Ω–∏-–∞–ø–ø
   - –û—Ç–∫—Ä–æ–π DevTools ‚Üí Console
   - –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏: `üì¶ –ó–∞–≥—Ä—É–∂–µ–Ω—ã –∞–¥—Ä–µ—Å–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞: X`
   - –ï—Å–ª–∏ `X = 0`, –ø—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞

2. **–ï—Å–ª–∏ –∞–¥—Ä–µ—Å–∞ –≤—Å—ë –µ—â—ë –ø—Ä–æ–ø–∞–¥–∞—é—Ç:**
   - –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Render.com –Ω–∞ –æ—à–∏–±–∫–∏
   - –ü—Ä–æ–≤–µ—Ä—å –ë–î –Ω–∞–ø—Ä—è–º—É—é (–µ—Å—Ç—å –ª–∏ –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ `addresses`)
   - –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ `saveUserData()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

3. **–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –º–∏–≥—Ä–∞—Ü–∏—è—Ö:**
   - –£–±–µ–¥–∏—Å—å, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –¥—Ä–æ–ø–∞—é—Ç —Ç–∞–±–ª–∏—Ü—É `addresses`
   - –ò—Å–ø–æ–ª—å–∑—É–π `ALTER TABLE` –≤–º–µ—Å—Ç–æ `DROP TABLE + CREATE TABLE`

